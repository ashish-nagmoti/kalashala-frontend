import{r as l,j as t,S as C,L as _}from"./index-BPVEKsek.js";import{e as u}from"./apiHelpers-DDwic4r0.js";const A=()=>{const[a,p]=l.useState([]),[i,c]=l.useState([]),[g,d]=l.useState(!0),[m,h]=l.useState(null),[r,f]=l.useState({artStyle:"",location:""}),[n,j]=l.useState("");l.useEffect(()=>{(async()=>{try{const s=await u("/custom_auth/get-csrf-token/",{method:"GET",credentials:"include"});if(s.ok){const o=await s.json();j(o.csrfToken)}}catch(s){console.error("Error fetching CSRF token:",s)}})()},[]),l.useEffect(()=>{n&&(async()=>{d(!0),h(null);try{const s=await u("/custom_auth/artists/",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":n}});if(!s.ok)throw new Error(`Failed to fetch artists: ${s.statusText}`);const o=await s.json();p(o),c(o)}catch(s){console.error("Error fetching artists:",s),h("Failed to load artists. Please try again later.")}finally{d(!1)}})()},[n]),l.useEffect(()=>{let e=[...a];r.artStyle&&(e=e.filter(s=>s.art_style&&s.art_style.toLowerCase().includes(r.artStyle.toLowerCase())||s.portfolio_items&&s.portfolio_items.some(o=>o.category&&o.category.toLowerCase().includes(r.artStyle.toLowerCase())))),r.location&&(e=e.filter(s=>s.location&&s.location.toLowerCase().includes(r.location.toLowerCase()))),c(e)},[a,r]);const y=e=>{const s=a.filter(o=>o.name.toLowerCase().includes(e.toLowerCase())||o.art_style&&o.art_style.toLowerCase().includes(e.toLowerCase())||o.location&&o.location.toLowerCase().includes(e.toLowerCase()));c(s)},x=e=>{const{name:s,value:o}=e.target;f(S=>({...S,[s]:o}))},N=[...new Set(a.flatMap(e=>{var s;return[e.art_style,...((s=e.portfolio_items)==null?void 0:s.map(o=>o.category))||[]]}).filter(Boolean))],v=[...new Set(a.map(e=>e.location).filter(Boolean))],w=e=>(e.portfolio_items&&e.portfolio_items.length>0,"/placeholder.svg"),b=e=>e.art_style?e.art_style:e.portfolio_items&&e.portfolio_items.length>0&&e.portfolio_items[0].category||"Artist";return t.jsx("div",{className:"py-8",children:t.jsxs("div",{className:"container-custom",children:[t.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Discover Talented Artisans"}),t.jsx("div",{className:"mb-8",children:t.jsx(C,{placeholder:"Search artists by name, art style ...",onSearch:y})}),t.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[t.jsx("div",{className:"md:w-1/4",children:t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsx("h2",{className:"font-semibold text-lg mb-4",children:"Filters"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Art Style"}),t.jsxs("select",{name:"artStyle",value:r.artStyle,onChange:x,className:"w-full p-2 border border-gray-300 rounded-md",children:[t.jsx("option",{value:"",children:"All Styles"}),N.map((e,s)=>t.jsx("option",{value:e,children:e},s))]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Location"}),t.jsxs("select",{name:"location",value:r.location,onChange:x,className:"w-full p-2 border border-gray-300 rounded-md",children:[t.jsx("option",{value:"",children:"All Locations"}),v.map((e,s)=>t.jsx("option",{value:e,children:e},s))]})]}),t.jsx("button",{onClick:()=>f({artStyle:"",location:""}),className:"text-sm text-gray-600 hover:text-black",children:"Clear Filters"})]})}),t.jsx("div",{className:"md:w-3/4",children:g?t.jsx("div",{className:"flex justify-center items-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-black"})}):m?t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-red-600",children:m})}):i.length===0?t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-500",children:"No artists found matching your criteria."})}):t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(e=>t.jsxs(_,{to:`/artists/${e.id}`,className:"card group",children:[t.jsx("div",{className:"aspect-square overflow-hidden",children:t.jsx("img",{src:w(e),alt:e.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"})}),t.jsxs("div",{className:"p-4",children:[t.jsx("h3",{className:"font-semibold text-lg",children:e.name}),t.jsx("p",{className:"text-sm text-gray-600",children:b(e)}),e.location&&t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.location}),t.jsx("div",{className:"flex mt-2",children:e.portfolio_items&&t.jsxs("p",{className:"text-xs text-gray-500",children:[e.portfolio_items.length," ",e.portfolio_items.length===1?"project":"projects"]})})]})]},e.id))})})]})]})})};export{A as default};
