import{r as n,j as e,S as L,L as v,P as S,b as P,d as F}from"./index-BPVEKsek.js";import{e as R,a as E}from"./apiHelpers-DDwic4r0.js";const M=()=>{const[u,i]=n.useState([]),[c,d]=n.useState([]),[y,p]=n.useState(!0),[g,f]=n.useState(null),[t,j]=n.useState({category:"all",level:"all",priceRange:"all"});n.useEffect(()=>{(async()=>{p(!0);try{console.log("Fetching courses from API...");const l=await R("/blog/list/?content_type=course",{credentials:"include"});if(console.log("API Response status:",l.status),l.ok){const r=await l.json();console.log("API Response data:",r);const o=Array.isArray(r)?r:r.results||[];console.log("Courses array:",o);const h=o.map(a=>{var b;console.log("Processing course:",a);let x={};return a.course_details&&(x=Array.isArray(a.course_details)?a.course_details[0]||{}:a.course_details),{id:a.id,title:a.title,description:a.description,instructor:((b=a.contributor)==null?void 0:b.name)||"Anonymous",thumbnail:a.thumbnail?E(a.thumbnail.startsWith("/media")?a.thumbnail:`/media/${a.thumbnail}`):"/placeholder.svg?height=200&width=300",rating:4.5,reviews:Math.floor(Math.random()*100)+10,price:parseFloat(x.price||0),duration:x.duration||"Not specified",level:"All Levels",category:a.category||"Uncategorized"}});console.log("Processed courses:",h),d(h),i(h)}else console.error("Failed to fetch courses",l),d([]),i([]),f("Failed to load courses. Please try again later.")}catch(l){console.error("Error fetching courses:",l),d([]),i([]),f("Error connecting to server. Please try again later.")}finally{p(!1)}})()},[]);const N=s=>{if(!s.trim()){i(c);return}const l=c.filter(r=>r.title.toLowerCase().includes(s.toLowerCase())||r.instructor.toLowerCase().includes(s.toLowerCase())||r.category.toLowerCase().includes(s.toLowerCase()));i(l)},w=()=>{let s=[...c];if(t.category!=="all"&&(s=s.filter(l=>l.category===t.category)),t.level!=="all"&&(s=s.filter(l=>l.level===t.level)),t.priceRange!=="all")switch(t.priceRange){case"under1000":s=s.filter(l=>l.price<1e3);break;case"1000to1500":s=s.filter(l=>l.price>=1e3&&l.price<=1500);break;case"over1500":s=s.filter(l=>l.price>1500);break}i(s)},m=s=>{const{name:l,value:r}=s.target;j(o=>({...o,[l]:r}))},C=()=>{j({category:"all",level:"all",priceRange:"all"}),i(c)},A=["all",...new Set(c.map(s=>s.category))],k=["all",...new Set(c.map(s=>s.level))];return e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"container-custom",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Learn Skills From Top Artists"}),e.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Enhance your craft with expert-led courses. Learn traditional techniques, modern approaches, and business skills to succeed as an artisan."})]}),e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("div",{className:"w-2/3",children:e.jsx(L,{placeholder:"Search for courses...",onSearch:N})}),e.jsx("div",{children:e.jsxs(v,{to:"/course-create",className:"btn-primary flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4"}),"Add Course"]})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsx("div",{className:"lg:w-1/4",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[e.jsx("h2",{className:"font-semibold text-lg mb-4",children:"Filters"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Category"}),e.jsx("select",{name:"category",value:t.category,onChange:m,className:"w-full p-2 border border-gray-300 rounded-md",children:A.map((s,l)=>e.jsx("option",{value:s,children:s==="all"?"All Categories":s},l))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Level"}),e.jsx("select",{name:"level",value:t.level,onChange:m,className:"w-full p-2 border border-gray-300 rounded-md",children:k.map((s,l)=>e.jsx("option",{value:s,children:s==="all"?"All Levels":s},l))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Price Range"}),e.jsxs("select",{name:"priceRange",value:t.priceRange,onChange:m,className:"w-full p-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"all",children:"All Prices"}),e.jsx("option",{value:"under1000",children:"Under ₹1,000"}),e.jsx("option",{value:"1000to1500",children:"₹1,000 - ₹1,500"}),e.jsx("option",{value:"over1500",children:"Over ₹1,500"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:w,className:"btn-primary flex-1",children:"Apply"}),e.jsx("button",{onClick:C,className:"btn-secondary flex-1",children:"Reset"})]})]})]})}),e.jsx("div",{className:"lg:w-3/4",children:y?e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-black"})}):g?e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-800 p-4 rounded-lg mb-4",children:e.jsx("p",{children:g})}):u.length===0?e.jsx("div",{className:"text-center py-12 bg-white rounded-lg",children:e.jsx("p",{className:"text-gray-500",children:"No courses found matching your criteria."})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(s=>e.jsxs("div",{className:"card group",children:[e.jsxs("div",{className:"aspect-video relative overflow-hidden",children:[e.jsx("img",{src:s.thumbnail||"/placeholder.svg",alt:s.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-20 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("button",{className:"w-12 h-12 rounded-full bg-white flex items-center justify-center",children:e.jsx(P,{className:"w-5 h-5 text-black"})})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center text-xs text-gray-500 mb-2",children:[e.jsx("span",{children:s.level}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{children:s.duration})]}),e.jsx("h3",{className:"font-semibold text-lg mb-2 line-clamp-2",children:s.title}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["By ",s.instructor]}),e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"flex",children:[1,2,3,4,5].map(l=>e.jsx(F,{className:`w-4 h-4 ${l<=Math.floor(s.rating)?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},l))}),e.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",s.reviews,")"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"font-bold",children:["₹",s.price]}),e.jsx(v,{to:`/courses/${s.id}`,className:"text-xs font-medium hover:underline",children:"Enroll"})]})]})]},s.id))})})]})]})})};export{M as default};
